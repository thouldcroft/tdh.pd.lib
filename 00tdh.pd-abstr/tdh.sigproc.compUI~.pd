#N canvas 48 23 1158 704 12;
#X text -276 -163 Source: https://designingsound.org/2013/06/28/tutorial-a-compressor-in-pure-data/
, f 81;
#X obj 154 -33 inlet thresh;
#X obj 291 -32 inlet ratio;
#X obj 425 -35 inlet attRel;
#X obj 565 -33 inlet makeup;
#X obj 705 -34 inlet rmsPeakSw;
#X obj 154 25 s \$0-thresh;
#N canvas 634 97 450 300 dbFStodBlin 0;
#X obj 60 50 inlet;
#X obj 60 80 + 100;
#X obj 60 110 dbtorms;
#X obj 60 140 outlet;
#X text 110 80 convert dBFS (-100 to 0) to dBPD (0 to 100);
#X text 120 110 convert dBPD to dBlin ("0.0 to 1.0");
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X restore 154 -4 pd dbFStodBlin;
#N canvas 0 22 450 300 inverse 0;
#X obj 54 43 inlet;
#X obj 54 72 swap 1;
#X obj 54 101 /;
#X obj 54 130 outlet;
#X text 100 100 Produces 1/ratio;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 2 1;
#X connect 2 0 3 0;
#X restore 291 -3 pd inverse;
#X obj 291 26 s \$0-ratio;
#N canvas 0 22 450 300 mstofreq 0;
#X obj 70 30 inlet;
#X obj 70 59 swap 1000;
#X obj 70 88 /;
#X obj 70 117 outlet;
#X text 120 90 Produces 1000/time in ms;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 2 1;
#X connect 2 0 3 0;
#X restore 425 -6 pd mstofreq;
#X obj 425 23 s \$0-att-rel;
#N canvas 634 97 450 300 dbFStodBlin 0;
#X obj 60 50 inlet;
#X obj 60 80 + 100;
#X obj 60 110 dbtorms;
#X obj 60 140 outlet;
#X text 110 80 convert dBFS (-100 to 0) to dBPD (0 to 100);
#X text 120 110 convert dBPD to dBlin ("0.0 to 1.0");
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X restore 565 -3 pd dbFStodBlin;
#X obj 565 27 s \$0-makeup;
#X obj 705 -4 s \$0-rmsPeakSw;
#X obj 865 -5 s \$0-lookahead;
#X obj 865 -34 inlet lookahead;
#X obj 989 -75 loadbang;
#X msg 989 -34 0;
#X msg 825 -34 0;
#X msg 665 -34 40;
#X msg 525 -34 25;
#X msg 385 -34 25;
#X msg 255 -34 -20;
#X obj 160 123 vsl 15 128 0 127 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 50 1;
#X floatatom 160 259 5 0 0 3 Thresh - -;
#X msg 160 64 set \$1;
#X obj 221 123 vsl 15 128 0 127 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 221 259 5 0 0 3 Ratio - -;
#X msg 221 64 set \$1;
#X obj 280 123 vsl 15 128 0 127 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 280 259 5 0 0 3 Att-Rel - -;
#X msg 280 64 set \$1;
#X obj 341 123 vsl 15 128 0 127 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 341 259 5 0 0 3 Makeup - -;
#X msg 341 64 set \$1;
#X obj 401 123 vsl 15 128 0 127 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 401 259 5 0 0 3 Look - -;
#X msg 401 64 set \$1;
#X obj 160 317 s \$0-toThresh;
#X obj 222 347 s \$0-toRatio;
#X obj 280 376 s \$0-toAttRel;
#X obj 342 406 s \$0-toMakeup;
#X obj 154 -62 r \$0-toThresh;
#X obj 291 -61 r \$0-toRatio;
#X obj 425 -64 r \$0-toAttRel;
#X obj 565 -63 r \$0-toMakeup;
#X obj 459 263 hradio 15 1 0 2 empty empty Peak/RMS -6 25 0 12 -262144
-1 -1 0;
#N canvas 125 23 811 622 comp-ch1 0;
#X obj 16 5 inlet~;
#N canvas 321 32 959 746 peak-gain-computation~ 0;
#X obj 293 178 inlet~;
#X obj 293 217 abs~;
#X text 180 220 Peak detection;
#X obj -30 10 cnv 1 200 1 empty empty Peak\\\ Gain\\\ Computation 2
12 0 14 -233017 -66577 0;
#X obj 293 680 outlet~;
#X text 0 129 • If the signal is above the threshold:;
#X text 0 91 • If the signal is below the thresh:;
#X text 40 148 • output = threshold + (input - threshold)/ratio;
#X text 40 109 • output = input;
#X obj 293 340 -~;
#X floatatom 311 290 5 0 0 1 threshold - -;
#X text 136 290 input - threshold;
#X floatatom 311 422 5 0 0 1 ratio - -;
#X text 65 420 (input - threshold) / ratio;
#X obj 260 470 /~;
#X floatatom 311 554 5 0 0 1 threshold - -;
#X text -16 550 threshold + (input - threshold) / ratio;
#X obj 293 470 *~;
#X text -16 450 * multiply by the INVERSE of the ratio \, instead of
the ratio \, because multiplication is less computationally expensive
(inverse calculated elsewhere), f 42;
#X obj 311 250 r \$0-thresh;
#X obj 311 380 r \$0-ratio;
#X obj 311 520 r \$0-thresh;
#X text -30 66 • Gain Computation for Downward Compression:;
#X text -30 40 • Peak Detection -> Gain Computation -> Gain Computation
/ Peak Detection, f 74;
#X obj 476 430 +~ 0;
#X obj 293 600 +~;
#X obj 293 629 /~;
#X text 271 290 >;
#X text 272 419 >;
#X text 275 549 >;
#X text 260 284 _;
#X text 260 413 _;
#X text 263 543 _;
#X text -40 720 _;
#X text 516 430 This doesn't do anything \, it just makes the patch
neater., f 30;
#X text 930 720 _;
#X obj 600 180 inlet;
#X obj 600 209 switch~;
#X connect 0 0 1 0;
#X connect 1 0 9 0;
#X connect 1 0 24 0;
#X connect 9 0 17 0;
#X connect 10 0 9 1;
#X connect 12 0 17 1;
#X connect 15 0 25 1;
#X connect 17 0 25 0;
#X connect 19 0 10 0;
#X connect 20 0 12 0;
#X connect 21 0 15 0;
#X connect 24 0 26 1;
#X connect 25 0 26 0;
#X connect 26 0 4 0;
#X connect 36 0 37 0;
#X restore 433 175 pd peak-gain-computation~;
#N canvas 296 23 972 750 rms-gain-computation 0;
#X obj 333 -712 inlet~;
#X obj 10 -900 cnv 5 200 1 empty empty RMS\\\ Gain\\\ Computation 2
12 0 14 -233017 -66577 0;
#X obj 333 -160 outlet~;
#X text 40 -781 • If the signal is above the threshold:;
#X text 40 -819 • If the signal is below the thresh:;
#X text 80 -762 • output = threshold + (input - threshold)/ratio
;
#X text 80 -801 • output = input;
#X obj 333 -500 -~;
#X floatatom 351 -550 5 0 0 1 threshold - -;
#X text 176 -550 input - threshold;
#X floatatom 351 -418 5 0 0 1 ratio - -;
#X text 105 -420 (input - threshold) / ratio;
#X obj 300 -370 /~;
#X floatatom 351 -286 5 0 0 1 threshold - -;
#X text 24 -290 threshold + (input - threshold) / ratio;
#X obj 333 -370 *~;
#X text 24 -390 * multiply by the INVERSE of the ratio \, instead of
the ratio \, because multiplication is less computationally expensive
(inverse calculated elsewhere), f 42;
#X obj 351 -590 r \$0-thresh;
#X obj 351 -460 r \$0-ratio;
#X obj 351 -320 r \$0-thresh;
#X text 10 -844 • Gain Computation for Downward Compression:;
#X obj 516 -410 +~ 0;
#X obj 333 -240 +~;
#X obj 333 -211 /~;
#X text 311 -550 >;
#X text 312 -421 >;
#X text 315 -291 >;
#X text 300 -556 _;
#X text 300 -427 _;
#X text 303 -297 _;
#X text 0 -120 _;
#X text 556 -410 This doesn't do anything \, it just makes the patch
neater., f 30;
#X text 970 -120 _;
#X obj 333 -670 env~ 512;
#X text 113 -670 calculate the RMS value in dB;
#X obj 333 -637 dbtorms~;
#X text 116 -637 rms value in linear amp;
#X text 970 -960 _;
#X text 10 -870 • RMS Value -> Gain Computation -> Gain Computation
/ RMS Value, f 74;
#X obj 540 -709 inlet;
#X obj 540 -680 switch~;
#X connect 0 0 33 0;
#X connect 7 0 15 0;
#X connect 8 0 7 1;
#X connect 10 0 15 1;
#X connect 13 0 22 1;
#X connect 15 0 22 0;
#X connect 17 0 8 0;
#X connect 18 0 10 0;
#X connect 19 0 13 0;
#X connect 21 0 23 1;
#X connect 22 0 23 0;
#X connect 23 0 2 0;
#X connect 33 0 35 0;
#X connect 35 0 7 0;
#X connect 35 0 21 0;
#X connect 39 0 40 0;
#X restore 233 175 pd rms-gain-computation;
#X obj 233 285 clip~ 0 1;
#X text 306 265 prevents the compressor from gaining the signal positively
when the threshold is at 0;
#X obj 233 385 lop~;
#X text 360 315 Using a lowpass filter as a ramp generator \, converting
time in ms to frequency (f = 1000 / time) (calculation done elsewhere)
;
#N canvas 0 22 450 300 delwrite 0;
#X obj 40 91 inlet~;
#X obj 40 120 delwrite~ \$0-comp 500;
#X obj 43 174 outlet~;
#X text 30 -10 Pd can't employ a delay less than a block size (1.4ms
typically) \, unless you encapsulate [delwrite~] and [delread~] in
subpatches \, give each a dummy [outlet~] and [inlet~] and connect
them. THIS WAS A BRAND NEW TOPIC TO ME!!;
#X connect 0 0 1 0;
#X restore 16 145 pd delwrite;
#N canvas 0 22 450 300 delread 0;
#X obj 20 111 inlet~;
#X obj 20 180 outlet~;
#X text 10 10 Pd can't employ a delay less than a block size (1.4ms
typically) \, unless you encapsulate [delwrite~] and [delread~] in
subpatches \, give each a dummy [outlet~] and [inlet~] and connect
them. THIS WAS A BRAND NEW TOPIC TO ME!!;
#X obj 20 150 delread~ \$0-comp 0;
#X obj 160 110 inlet;
#X connect 3 0 1 0;
#X connect 4 0 3 0;
#X restore 16 235 pd delread;
#X text 56 115 lookahead;
#X floatatom 83 207 5 0 0 1 lookahead_time - -;
#X obj 215 425 *~;
#X text 236 145 RMS Gain Computation;
#X text 436 145 Peak Gain Computation;
#X obj 215 534 *~;
#X obj 246 415 r \$0-makeup;
#X obj 246 474 pack f 5;
#X obj 246 503 line~;
#X obj 215 563 outlet~;
#X obj 391 54 t f f;
#X obj 391 83 == 0;
#X obj 258 315 r \$0-att-rel;
#X obj 391 5 r \$0-rmsPeakSw;
#X obj 83 178 r \$0-lookahead;
#X floatatom 246 445 5 0 0 1 makeup - -;
#X floatatom 258 339 5 0 0 0 - - -;
#X obj 391 29 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X connect 0 0 7 0;
#X connect 0 0 2 0;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 5 0 11 1;
#X connect 7 0 8 0;
#X connect 8 0 11 0;
#X connect 10 0 8 1;
#X connect 11 0 14 0;
#X connect 14 0 18 0;
#X connect 15 0 24 0;
#X connect 16 0 17 0;
#X connect 17 0 14 1;
#X connect 19 0 20 0;
#X connect 19 1 1 1;
#X connect 20 0 2 1;
#X connect 21 0 25 0;
#X connect 22 0 26 0;
#X connect 23 0 10 0;
#X connect 24 0 16 0;
#X connect 25 0 5 1;
#X connect 26 0 19 0;
#X restore 51 316 pd comp-ch1;
#X obj 54 -81 inlet~;
#X obj 466 120 vu 15 120 empty empty -1 -8 0 10 -66577 -1 1 0;
#X obj 465 70 env~;
#X obj 109 123 vu 15 120 empty empty -1 -8 0 10 -66577 -1 1 0;
#X obj 108 75 env~;
#X text 461 240 Out;
#X text 107 243 In;
#X text 100 99 In;
#X text 158 101 Thr;
#X text 211 100 Rat;
#X text 266 99 A-R;
#X text 340 101 MU;
#X text 500 100 LA;
#X text 422 100 Sw;
#X obj 459 325 s \$0-rmsPeakSw;
#X obj 402 436 s \$0-lookahead;
#X text 101 292 Out;
#X connect 1 0 7 0;
#X connect 2 0 8 0;
#X connect 3 0 10 0;
#X connect 4 0 12 0;
#X connect 5 0 14 0;
#X connect 7 0 6 0;
#X connect 8 0 9 0;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 16 0 15 0;
#X connect 17 0 18 0;
#X connect 17 0 19 0;
#X connect 17 0 20 0;
#X connect 17 0 21 0;
#X connect 17 0 22 0;
#X connect 17 0 23 0;
#X connect 18 0 15 0;
#X connect 19 0 14 0;
#X connect 20 0 12 0;
#X connect 21 0 10 0;
#X connect 22 0 8 0;
#X connect 23 0 7 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 25 0 39 0;
#X connect 26 0 24 0;
#X connect 27 0 28 0;
#X connect 28 0 29 0;
#X connect 28 0 40 0;
#X connect 29 0 27 0;
#X connect 30 0 31 0;
#X connect 31 0 32 0;
#X connect 31 0 41 0;
#X connect 32 0 30 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 34 0 42 0;
#X connect 35 0 33 0;
#X connect 36 0 37 0;
#X connect 37 0 38 0;
#X connect 37 0 64 0;
#X connect 38 0 36 0;
#X connect 43 0 7 0;
#X connect 44 0 8 0;
#X connect 45 0 10 0;
#X connect 46 0 12 0;
#X connect 47 0 63 0;
#X connect 48 0 51 0;
#X connect 49 0 53 0;
#X connect 49 0 48 0;
#X connect 51 0 50 0;
#X connect 53 0 52 0;
#X coords 0 -1 1 1 420 210 2 100 100;
